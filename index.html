<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ncexs Toolkit</title>
<meta name="description" content="ncexs Toolkit - Simple tool to optimize and clean Windows">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root {
  --primary-color: #0366d6;
  --secondary-color: #00aaff;
  --text-color: #222;
  --text-muted: #666;
  --bg-color: #f6f8fa;
  --card-bg: #e8ebf0;
  --shadow: 0 2px 10px rgba(0,0,0,0.1);
}

* { box-sizing: border-box; }

body {
  font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
  margin: 0; padding: 0;
  color: var(--text-color);
  background: var(--bg-color);
  line-height: 1.6;
}

header {
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  padding: 4rem 1rem 3rem;
  text-align: center;
  color: white;
  border-bottom-left-radius: 30px;
  border-bottom-right-radius: 30px;
  box-shadow: var(--shadow);
  margin-bottom: 2rem;
}

header h1 {
  margin: 0;
  font-size: 2.8rem;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 3px;
  font-weight: 800;
}

header h1 span {
  display: inline-block;
  animation: bounce 2s ease infinite alternate;
  text-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

header h1 span:nth-child(1) { animation-delay: 0.1s; }
header h1 span:nth-child(2) { animation-delay: 0.2s; }
header h1 span:nth-child(3) { animation-delay: 0.3s; }
header h1 span:nth-child(4) { animation-delay: 0.4s; }
header h1 span:nth-child(5) { animation-delay: 0.5s; }
header h1 span:nth-child(6) { animation-delay: 0.6s; }
header h1 span:nth-child(7) { animation-delay: 0.7s; }
header h1 span:nth-child(8) { animation-delay: 0.8s; }
header h1 span:nth-child(9) { animation-delay: 0.9s; }
header h1 span:nth-child(10) { animation-delay: 1.0s; }
header h1 span:nth-child(11) { animation-delay: 1.1s; }
header h1 span:nth-child(12) { animation-delay: 1.2s; }
header h1 span:nth-child(13) { animation-delay: 1.3s; }

@keyframes bounce {
  0% { transform: translateY(0); }
  100% { transform: translateY(-10px); }
}

header p {
  margin: 1rem auto 0;
  font-size: 1.1rem;
  max-width: 600px;
  opacity: 0.95;
}

.date-badge {
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  display: inline-flex;
  gap: 10px;
  margin-top: 1.5rem;
  border: 1px solid rgba(255,255,255,0.3);
  font-weight: 600;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.tabs-container {
  display: flex;
  justify-content: center;
  margin-top: -3.5rem;
  margin-bottom: 2rem;
  position: relative;
  z-index: 10;
}

.tabs {
  background: white;
  padding: 0.5rem;
  border-radius: 50px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
  display: flex;
  gap: 0.5rem;
}

.tab {
  padding: 0.8rem 2rem;
  border-radius: 40px;
  cursor: pointer;
  font-weight: 700;
  color: var(--text-muted);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.tab:hover { background: #f0f4f8; color: var(--primary-color); }
.tab.active {
  background: var(--primary-color);
  color: white;
  box-shadow: 0 4px 12px rgba(3, 102, 214, 0.3);
}

.container {
  max-width: 850px;
  margin: 0 auto;
  padding: 0 1.5rem;
  min-height: 500px;
}

.card {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 2rem;
  margin-bottom: 2rem;
  border: 1px solid #eef2f5;
  box-shadow: var(--shadow);
  transition: transform 0.3s ease;
  position: relative;
  overflow: hidden;
}

.card:hover { transform: translateY(-5px); }

.card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 6px;
  background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
}

.card.test-build {
  background: #fcfaff;
  border: 1px solid #d8b9ff;
}
.card.test-build::before {
  background: #8957e5;
}
.card.test-build h3 {
  color: #6e40c9;
}

.card h3 {
  margin-top: 0;
  font-size: 1.5rem;
  color: var(--primary-color);
  display: flex;
  align-items: center;
  gap: 10px;
}

.card p, .card ul, .card ol { margin: 0.5rem 0; color: #444; }
.card ol { padding-left: 1.5rem; }
.card ul { padding-left: 1.5rem; list-style-type: disc; }
.card li { margin-bottom: 0.5rem; }
.card ol ul {
    margin-top: 0.5rem;
    background: rgba(255,255,255,0.5);
    padding: 1rem 1rem 1rem 2.5rem;
    border-radius: 8px;
    border-left: 3px solid var(--primary-color);
}

.changelog-box {
  background: #f8f9fa;
  border: 1px solid #e1e4e8;
  border-radius: 12px;
  padding: 1.5rem;
  margin: 1rem 0;
  max-height: 350px;
  overflow-y: auto;
  font-size: 0.95rem;
}

.changelog-box::-webkit-scrollbar { width: 8px; }
.changelog-box::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 8px; }
.changelog-box::-webkit-scrollbar-thumb { background: #ccc; border-radius: 8px; }
.changelog-box::-webkit-scrollbar-thumb:hover { background: var(--secondary-color); }

.changelog-content h1 { font-size: 1.2rem; border-bottom: 2px solid #ddd; padding-bottom: 5px; margin-top: 1.5rem; color: #333; }
.changelog-content h2 { font-size: 1.1rem; color: var(--primary-color); margin-top: 1rem; }
.changelog-content ul { padding-left: 1.2rem; }
.changelog-content li { margin-bottom: 6px; }

.btn-group { display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap; }

.btn {
  padding: 0.8rem 1.5rem;
  border-radius: 12px;
  text-decoration: none;
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: all 0.2s;
  border: none;
  cursor: pointer;
}

.btn-primary {
  background: #2ea44f;
  color: white;
  box-shadow: 0 4px 10px rgba(46, 164, 79, 0.2);
}
.btn-primary:hover { background: #2c974b; transform: scale(1.02); }

.btn-beta {
  background: #8957e5;
  color: white;
  box-shadow: 0 4px 10px rgba(137, 87, 229, 0.2);
}
.btn-beta:hover { background: #6e40c9; transform: scale(1.02); }

.btn-secondary {
  background: white;
  color: var(--primary-color);
  border: 2px solid var(--primary-color);
}
.btn-secondary:hover { background: #f0f8ff; }

.code-box {
  background: #24292f;
  color: #fff;
  padding: 1rem;
  border-radius: 8px;
  font-family: monospace;
  margin: 0.5rem 0;
  display: block;
  overflow-x: auto;
}

.hidden { display: none; }
.section-label {
    font-weight: bold;
    color: #666;
    margin-top: 2rem;
    margin-bottom: 1rem;
    display: block;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 1px;
}

footer {
  text-align: center;
  padding: 3rem;
  color: #888;
  font-size: 0.9rem;
  margin-top: 2rem;
}
footer a { color: var(--primary-color); text-decoration: none; }

@media (max-width: 600px) {
  header h1 { font-size: 2rem; }
  .tabs { flex-wrap: wrap; justify-content: center; }
  .card { padding: 1.5rem; }
  .btn { width: 100%; justify-content: center; }
}
</style>
</head>
<body>

<header>
  <h1>
    <span>n</span><span>c</span><span>e</span><span>x</span><span>s</span>
    <span> </span>
    <span>T</span><span>o</span><span>o</span><span>l</span><span>k</span><span>i</span><span>t</span>
  </h1>
  <p>All-in-One Windows Toolkit<br>Simple, fast, and safe tools to clean, optimize, and maintain your PC</p>
  
  <div class="date-badge">
    <span id="time">00:00</span>
    <span style="opacity:0.5">|</span>
    <span id="date">Loading...</span>
  </div>
</header>

<div class="tabs-container">
  <div class="tabs">
    <div class="tab active" onclick="showTab('home', this)">Introduction</div>
    <div class="tab" onclick="showTab('projects', this)">Downloads</div>
    <div class="tab" onclick="showTab('guide', this)">How to Use</div>
  </div>
</div>

<div id="home" class="container">
  <div class="card">
    <h3><i class="fas fa-user-circle"></i> Hello, I'm ncexs</h3>
    <p>I am a developer learning to build lightweight & useful tools for everyone. I created this toolkit to help myself and others manage their Windows systems efficiently without "bloatware".</p>
    <div class="btn-group">
      <a href="https://github.com/ncexs" target="_blank" class="btn btn-secondary"><i class="fab fa-github"></i> GitHub Profile</a>
    </div>
  </div>
  
  <div class="card">
    <h3><i class="fas fa-shield-alt"></i> Security & Trust</h3>
    <p>This toolkit is 100% transparent and open-source. It does not collect any personal data. You are free to audit the code.</p>
    <div class="btn-group">
      <a href="https://www.virustotal.com/" target="_blank" class="btn btn-secondary"><i class="fas fa-check-circle"></i> VirusTotal</a>
      <a href="https://saweria.co/ncexs" target="_blank" class="btn btn-secondary"><i class="fas fa-coffee"></i> Support Me</a>
    </div>
  </div>

  <div id="test-build-area"></div>
</div>

<div id="projects" class="container hidden">
  <div id="project-list">
    <div style="text-align:center; padding:3rem; color:#888;">
      <i class="fas fa-circle-notch fa-spin fa-2x" style="color:var(--primary-color)"></i>
      <p style="margin-top:1rem">Loading latest releases from GitHub...</p>
    </div>
  </div>
</div>

<div id="guide" class="container hidden">
  <div class="card">
    <h3><i class="fas fa-book-reader"></i> How to Use - ncexs Toolkit</h3>
    <ol>
      <li>Download the latest <b>ncexs-Toolkit.ps1</b> file.</li>
      <li>Open your <b>Start Menu</b>.</li>
      <li>Type <b>powershell</b> and press <b>Enter</b>. (A PowerShell window will open).</li>
      <li>In the PowerShell window, type this command and press <b>Enter</b>:
        <code class="code-box">Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process</code>
      </li>
      <li><b>Drag</b> file <b>ncexs-Toolkit.ps1</b> and <b>drop</b> it directly into the PowerShell window.</li>
      <li>Press <b>Enter</b> one last time to run the script.</li>
      <li>Select from the interactive menu (1‚Äì12):
        <ul>
          <li>1 ‚Üí System Information (Now with GPU Version & Free RAM)</li>
          <li>2 ‚Üí Junk Cleaner (Now with AMD/Intel/NVIDIA caches)</li>
          <li>3 ‚Üí Empty Recycle Bin</li>
          <li>4 ‚Üí Open Disk Cleanup</li>
          <li>5 ‚Üí Advanced Uninstaller (New registry-based uninstaller)</li>
          <li>6 ‚Üí Network Repair (Now 5-in-1: release, renew, flushdns, etc.)</li>
          <li>7 ‚Üí Power & Battery Utilities (New menu: Power Plans & Battery Report)</li>
          <li>8 ‚Üí Memory Optimizer</li>
          <li>9 ‚Üí Defragment & Optimize Drives</li>
          <li>10 ‚Üí System Health Checker (SFC & DISM)</li>
          <li>11 ‚Üí Language Settings</li>
          <li>12 ‚Üí Exit</li>
        </ul>
      </li>
      <li>Check <b>log_ncexs-toolkit.txt</b> for operation reports</li>
    </ol>
    <p>üí° Tip: Use regularly for optimal system performance. Always backup important data before performing any cleanup operations.</p>
  </div>

  <div class="card">
    <h3><i class="fas fa-info-circle"></i> Key Feature Explanation</h3>
    <p><b>Disk Cleanup (Menu 4):</b><br>
    This is the official cleaning tool from Windows. Its purpose is to delete safe-to-remove junk files like old Windows Update leftovers, log files, and thumbnail caches.</p>
    <p><b>SFC & DISM (Menu 10):</b><br>
    These are the two most powerful "self-repair" tools in Windows for fixing system issues (corrupt or missing files).</p>
  </div>

  <div class="card">
    <h3><i class="fas fa-book-reader"></i> How to Use - ncexs JunkCleaner</h3>
    <ol>
      <li>Extract the ZIP file (right-click ‚Üí Extract All)</li>
      <li>Double-click the .bat file</li>
      <li>If 'Windows protected your PC' appears: Click 'More info' ‚Üí 'Run anyway'</li>
      <li>Allow admin access when prompted</li>
      <li>Follow Y/N prompts for:
        <ul>
          <li>1 ‚Üí Junk & Cache Cleaner</li>
          <li>2 ‚Üí Deep Cleanup</li>
          <li>3 ‚Üí Antivirus Scan</li>
          <li>4 ‚Üí Clear RAM</li>
        </ul>
      </li>
      <li>Check <b>log_ncexs.txt</b> for cleanup report</li>
    </ol>
  </div>
</div>

<footer>
  <p>&copy; 2025 ncexs Toolkit &bull; Developed by <a href="https://github.com/ncexs" target="_blank">ncexs</a></p>
</footer>

<script>
function parseMarkdown(text) {
  if (!text) return "<em>No description available.</em>";
  
  let html = text.replace(/\r\n/g, '\n').replace(/</g, '&lt;').replace(/>/g, '&gt;');
  
  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');
  html = html.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
  html = html.replace(/\*(.*?)\*/g, '<i>$1</i>');
  html = html.replace(/^---$/gim, '<hr>');

  let lines = html.split('\n');
  let newLines = [];
  let inList = false;

  lines.forEach(line => {
    if (/^\s*[-*]\s+(.*)/.test(line)) {
      if (!inList) { newLines.push('<ul>'); inList = true; }
      newLines.push(`<li>${line.replace(/^\s*[-*]\s+/, '')}</li>`);
    } else {
      if (inList) { newLines.push('</ul>'); inList = false; }
      if (line.match(/^<h/) || line.match(/^<hr/)) newLines.push(line);
      else if (line.trim() !== '') newLines.push(`<p>${line}</p>`);
    }
  });
  if (inList) newLines.push('</ul>');
  return newLines.join('');
}

function showTab(id, el) {
  document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  if(el) el.classList.add('active');
}

async function loadProjects() {
  const container = document.getElementById('project-list');
  const testBuildArea = document.getElementById('test-build-area');
  
  try {
    const resTest = await fetch('https://api.github.com/repos/ncexs/ncexs-toolkit/contents/Test%20Build');
    const dataTest = resTest.ok ? await resTest.json() : [];

    if (Array.isArray(dataTest) && dataTest.length > 0) {
      let testHtml = '';
      dataTest.forEach(file => {
        if (file.name.toLowerCase() === 'readme.md') return;
        
        testHtml += `
          <div class="card test-build">
             <h3><i class="fas fa-flask"></i> Experimental Build: ${file.name}</h3>
             <p><b>‚ö†Ô∏è Experimental Build:</b> This version is for testing purposes only. It may contain bugs or unfinished features. Use at your own risk.</p>
             <div class="btn-group">
                <a href="${file.download_url}" class="btn btn-beta"><i class="fas fa-download"></i> Download Test Build</a>
                <a href="https://github.com/ncexs/ncexs-toolkit/tree/main/Test%20Build" target="_blank" class="btn btn-secondary"><i class="fab fa-github"></i> View Source</a>
             </div>
          </div>
        `;
      });
      testBuildArea.innerHTML = testHtml;
    }

    const [resTk, resJc] = await Promise.all([
      fetch('https://api.github.com/repos/ncexs/ncexs-toolkit/releases'),
      fetch('https://api.github.com/repos/ncexs/ncexs-junkcleaner/releases')
    ]);

    const dataTk = await resTk.json();
    const dataJc = await resJc.json();
    
    container.innerHTML = ''; 
    let htmlContent = '';

    const renderReleaseCard = (release, type) => {
      const icon = type === 'tk' ? 'fa-rocket' : 'fa-broom';
      const body = parseMarkdown(release.body);
      
      let dlUrl = release.html_url;
      if(release.assets.length > 0) dlUrl = release.assets[0].browser_download_url;

      return `
        <div class="card">
          <h3><i class="fas ${icon}"></i> ${release.name || release.tag_name}</h3>
          
          <div class="changelog-box">
            <div class="changelog-content">${body}</div>
          </div>

          <div class="btn-group">
            <a href="${dlUrl}" class="btn btn-primary"><i class="fas fa-download"></i> Download</a>
            <a href="${release.html_url}" target="_blank" class="btn btn-secondary"><i class="fab fa-github"></i> View on GitHub</a>
          </div>
        </div>
      `;
    };

    if(Array.isArray(dataTk)) dataTk.forEach(r => htmlContent += renderReleaseCard(r, 'tk'));
    if(Array.isArray(dataJc)) dataJc.forEach(r => htmlContent += renderReleaseCard(r, 'jc'));

    container.innerHTML = htmlContent;

  } catch (e) {
    container.innerHTML = `<p style="text-align:center; color:red">Error loading data: ${e}</p>`;
  }
}

function updateTime() {
  const now = new Date();
  const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
  const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
  
  let h = now.getHours();
  let m = now.getMinutes();
  const ampm = h >= 12 ? 'PM' : 'AM';
  h = h % 12; h = h ? h : 12;
  m = m < 10 ? '0'+m : m;
  
  document.getElementById('time').innerText = `${h}:${m} ${ampm}`;
  document.getElementById('date').innerText = `${days[now.getDay()]}, ${now.getDate()} ${months[now.getMonth()]}`;
}

window.addEventListener('DOMContentLoaded', () => {
  loadProjects();
  updateTime();
  setInterval(updateTime, 1000);
});
</script>

</body>
</html>